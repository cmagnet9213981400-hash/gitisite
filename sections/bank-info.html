<!-- 
  =================================
  Ù…Ø§Ú˜ÙˆÙ„: Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§Ù†Ú©ÛŒ (Bank Info)
  =================================
  Ø´Ø§Ù…Ù„: 
  - ØªØ´Ø®ÛŒØµ Ø®ÙˆØ¯Ú©Ø§Ø± Ù†Ø§Ù… Ø¨Ø§Ù†Ú© (Ø¨Ø¯ÙˆÙ† Ø¢ÛŒÚ©ÙˆÙ†)
  - Ù…Ø®ÙÛŒâ€ŒØ³Ø§Ø²ÛŒ ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø®Ø§Ù„ÛŒ Ø¯Ø± Ø®Ø±ÙˆØ¬ÛŒ
  - ØªØºÛŒÛŒØ± Ù…ØªÙ† Ø¨Ù‡ "Ú©Ù¾ÛŒ Ø´Ø¯"
-->
<section class="section" id="section-UNIQUE_ID" data-section="bank-info">
    <!-- Ù‡Ù†Ø¯Ù„ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ -->
    <div class="drag-handle">
        <i class="fas fa-arrows-alt-v"></i>
    </div>
    
    <!-- Ø¹Ù†ÙˆØ§Ù† Ø³Ú©Ø´Ù† -->
    <div class="section-title">
        <div class="section-title-text" contenteditable="true">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø±Ø¯Ø§Ø®Øª</div>
        <div class="delete-section" onclick="deleteSection('section-UNIQUE_ID')">ğŸ—‘ï¸</div>
    </div>
    
    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ -->
    <div class="section-content">
        <p class="bank-desc" contenteditable="true">Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®ØªØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø­Ø³Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ø²ÛŒØ± Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</p>
        
        <!-- Ú¯Ø±ÛŒØ¯ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ -->
        <div class="bank-grid" id="bank-grid-UNIQUE_ID">
            <!-- Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
        </div>

        <!-- Ø¯Ú©Ù…Ù‡ Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø§Ø±Øª -->
        <div class="bank-controls">
            <button class="btn-add-bank" id="add-bank-UNIQUE_ID">
                <i class="fas fa-plus-circle"></i> Ø§ÙØ²ÙˆØ¯Ù† Ú©Ø§Ø±Øª Ø¬Ø¯ÛŒØ¯
            </button>
        </div>
    </div>

    <!-- Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ -->
    <style>
        #section-UNIQUE_ID .bank-desc {
            margin-bottom: 20px;
            opacity: 0.8;
            font-size: 0.9rem;
        }

        #section-UNIQUE_ID .bank-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        #section-UNIQUE_ID .bank-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 25px;
            position: relative;
            transition: all 0.3s;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            color: var(--text-color);
            min-height: 200px;
            display: flex;
            flex-direction: column;
        }

        #section-UNIQUE_ID .bank-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        /* Ù‡Ø¯Ø± Ú©Ø§Ø±Øª (ÙÙ‚Ø· Ù†Ø§Ù… Ø¨Ø§Ù†Ú©) */
        #section-UNIQUE_ID .bank-header {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        #section-UNIQUE_ID .bank-name-input {
            width: 100%;
            background: transparent;
            border: none;
            color: var(--text-color);
            font-size: 1.3rem;
            font-weight: bold;
            text-align: center;
            outline: none;
        }
        
        #section-UNIQUE_ID .bank-name-input::placeholder {
            color: rgba(255,255,255,0.5);
        }

        /* ÙÛŒÙ„Ø¯Ù‡Ø§ */
        #section-UNIQUE_ID .bank-field-group {
            margin-bottom: 15px;
            position: relative;
            transition: opacity 0.3s;
        }
        
        #section-UNIQUE_ID .bank-field-group.is-empty {
            opacity: 0.7;
        }

        #section-UNIQUE_ID .bank-label {
            font-size: 0.75rem;
            opacity: 0.7;
            margin-bottom: 6px;
            display: block;
        }

        #section-UNIQUE_ID .bank-input {
            width: 100%;
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--glass-border);
            border-radius: 10px;
            padding: 10px 12px;
            color: var(--text-color);
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            letter-spacing: 2px;
            text-align: center;
            outline: none;
            transition: all 0.3s;
            direction: ltr;
        }

        #section-UNIQUE_ID .bank-input:focus {
            background: rgba(0,0,0,0.3);
            border-color: var(--primary-color);
        }
        
        #section-UNIQUE_ID .bank-input.copy-success {
            background: rgba(46, 204, 113, 0.2) !important;
            color: #2ecc71 !important;
            border-color: #2ecc71 !important;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif !important;
            letter-spacing: 0 !important;
            font-weight: bold;
        }

        /* Ø¯Ú©Ù…Ù‡ Ø­Ø°Ù Ú©Ø§Ø±Øª */
        #section-UNIQUE_ID .btn-delete-card {
            position: absolute;
            top: -10px;
            left: -10px;
            background: #ff6b6b;
            color: white;
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: all 0.3s;
            z-index: 10;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        #section-UNIQUE_ID .bank-card:hover .btn-delete-card {
            opacity: 1;
            top: 10px;
            left: 10px;
        }

        /* Ú©Ù†ØªØ±Ù„ Ø§ÙØ²ÙˆØ¯Ù† */
        #section-UNIQUE_ID .bank-controls {
            text-align: center;
            margin-top: 20px;
        }

        #section-UNIQUE_ID .btn-add-bank {
            background: var(--secondary-color);
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: background 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        #section-UNIQUE_ID .btn-add-bank:hover {
            background: var(--primary-color);
        }

        /* Visitor Mode Styles */
        body.visitor-mode #section-UNIQUE_ID .bank-input,
        body.visitor-mode #section-UNIQUE_ID .bank-name-input {
            background: transparent;
            border: none;
            padding: 5px 0;
            text-align: center;
            cursor: pointer;
            user-select: none;
            color: var(--text-color); /* Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø±Ù†Ú¯ Ù…ØªÙ† */
        }
        
        body.visitor-mode #section-UNIQUE_ID .bank-name-input {
            cursor: default;
        }

        body.visitor-mode #section-UNIQUE_ID .bank-input:hover {
            color: var(--primary-color);
            transform: scale(1.05);
        }

        body.visitor-mode #section-UNIQUE_ID .btn-delete-card,
        body.visitor-mode #section-UNIQUE_ID .bank-controls,
        body.visitor-mode #section-UNIQUE_ID .delete-section,
        body.visitor-mode #section-UNIQUE_ID .drag-handle {
            display: none !important;
        }

        /* Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø®Ø§Ù„ÛŒ Ø¯Ø± Ø®Ø±ÙˆØ¬ÛŒ Ù†Ù‡Ø§ÛŒÛŒ */
        body.visitor-mode #section-UNIQUE_ID .bank-field-group.is-empty {
            display: none !important;
        }
    </style>

    <!-- Ù…Ù†Ø·Ù‚ Ø¬Ø§ÙˆØ§Ø§Ø³Ú©Ø±ÛŒÙ¾Øª -->
    <script>
        (function() {
            const uid = 'UNIQUE_ID';
            const grid = document.getElementById('bank-grid-' + uid);
            const addBtn = document.getElementById('add-bank-' + uid);

            // Ù„ÛŒØ³Øª Ù†Ø§Ù… Ø¨Ø§Ù†Ú©â€ŒÙ‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ BIN
            const banks = {
                "603799": "Ø¨Ø§Ù†Ú© Ù…Ù„ÛŒ", "589210": "Ø¨Ø§Ù†Ú© Ø³Ù¾Ù‡", "627961": "Ø¨Ø§Ù†Ú© ØµÙ†Ø¹Øª Ùˆ Ù…Ø¹Ø¯Ù†", "603770": "Ø¨Ø§Ù†Ú© Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ",
                "628023": "Ø¨Ø§Ù†Ú© Ù…Ø³Ú©Ù†", "627353": "Ø¨Ø§Ù†Ú© ØªØ¬Ø§Ø±Øª", "502229": "Ø¨Ø§Ù†Ú© Ù¾Ø§Ø³Ø§Ø±Ú¯Ø§Ø¯", "627412": "Ø¨Ø§Ù†Ú© Ø§Ù‚ØªØµØ§Ø¯ Ù†ÙˆÛŒÙ†",
                "622106": "Ø¨Ø§Ù†Ú© Ù¾Ø§Ø±Ø³ÛŒØ§Ù†", "603769": "Ø¨Ø§Ù†Ú© ØµØ§Ø¯Ø±Ø§Øª", "610433": "Ø¨Ø§Ù†Ú© Ù…Ù„Øª", "621986": "Ø¨Ø§Ù†Ú© Ø³Ø§Ù…Ø§Ù†",
                "639346": "Ø¨Ø§Ù†Ú© Ø³ÛŒÙ†Ø§", "639607": "Ø¨Ø§Ù†Ú© Ø³Ø±Ù…Ø§ÛŒÙ‡", "636214": "Ø¨Ø§Ù†Ú© Ø¢ÛŒÙ†Ø¯Ù‡", "502806": "Ø¨Ø§Ù†Ú© Ø´Ù‡Ø±",
                "502938": "Ø¨Ø§Ù†Ú© Ø¯ÛŒ", "606373": "Ø¨Ø§Ù†Ú© Ù…Ù‡Ø± Ø§ÛŒØ±Ø§Ù†", "627381": "Ø¨Ø§Ù†Ú© Ø§Ù†ØµØ§Ø±", "505785": "Ø¨Ø§Ù†Ú© Ø§ÛŒØ±Ø§Ù† Ø²Ù…ÛŒÙ†",
                "505416": "Ø¨Ø§Ù†Ú© Ú¯Ø±Ø¯Ø´Ú¯Ø±ÛŒ", "639599": "Ø¨Ø§Ù†Ú© Ù‚ÙˆØ§Ù…ÛŒÙ†", "589463": "Ø¨Ø§Ù†Ú© Ø±ÙØ§Ù‡", "627760": "Ù¾Ø³Øª Ø¨Ø§Ù†Ú©",
                "502908": "ØªÙˆØ³Ø¹Ù‡ ØªØ¹Ø§ÙˆÙ†", "627488": "Ú©Ø§Ø±Ø¢ÙØ±ÛŒÙ†", "504172": "Ø¨Ø§Ù†Ú© Ø±Ø³Ø§Ù„Øª"
            };

            if (addBtn) {
                addBtn.addEventListener('click', () => {
                    addCard();
                });
            }

            function addCard() {
                const card = document.createElement('div');
                card.className = 'bank-card';

                card.innerHTML = `
                    <button class="btn-delete-card" title="Ø­Ø°Ù Ú©Ø§Ø±Øª">&times;</button>
                    
                    <div class="bank-header">
                        <input type="text" class="bank-name-input" placeholder="Ù†Ø§Ù… Ø¨Ø§Ù†Ú©" value="Ù†Ø§Ù… Ø¨Ø§Ù†Ú©">
                    </div>
                    
                    <div class="bank-field-group is-empty">
                        <label class="bank-label">Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª</label>
                        <input type="text" class="bank-input card-num" placeholder="0000-0000-0000-0000" maxlength="19">
                    </div>
                    
                    <div class="bank-field-group is-empty">
                        <label class="bank-label">Ø´Ù…Ø§Ø±Ù‡ Ø´Ø¨Ø§</label>
                        <input type="text" class="bank-input iban-num" placeholder="IR00-0000-0000-0000-0000-0000-00" maxlength="32">
                    </div>
                    
                    <div class="bank-field-group is-empty">
                        <label class="bank-label">Ø´Ù…Ø§Ø±Ù‡ Ø­Ø³Ø§Ø¨</label>
                        <input type="text" class="bank-input acc-num" placeholder="0000-0000-0000-0000">
                    </div>
                `;
                grid.appendChild(card);
                setupCardEvents(card);
            }

            function setupCardEvents(card) {
                const deleteBtn = card.querySelector('.btn-delete-card');
                const nameInput = card.querySelector('.bank-name-input');
                const cardInput = card.querySelector('.card-num');
                const ibanInput = card.querySelector('.iban-num');
                const accInput = card.querySelector('.acc-num');

                deleteBtn.addEventListener('click', () => {
                    if(confirm("Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ú©Ø§Ø±Øª Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ")) card.remove();
                });

                // ØªØ§Ø¨Ø¹ Ù…Ù‡Ù…: Ø°Ø®ÛŒØ±Ù‡ Ù…Ù‚Ø¯Ø§Ø± Ø¯Ø± attribute Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ø¯Ø± Ø®Ø±ÙˆØ¬ÛŒ innerHTML ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´Ø¯
                const updateAttr = (input) => {
                    input.setAttribute('value', input.value);
                };

                // Ø¨Ø±Ø±Ø³ÛŒ Ùˆ Ø§Ø¹Ù…Ø§Ù„ Ú©Ù„Ø§Ø³ is-empty
                const checkEmpty = (input) => {
                    const group = input.closest('.bank-field-group');
                    const val = input.value.trim();
                    // Ø´Ø±Ø· Ø®Ø§Ù„ÛŒ Ø¨ÙˆØ¯Ù†: Ù…ØªÙ† Ø®Ø§Ù„ÛŒØŒ ÛŒØ§ ÙÙ‚Ø· Ù‚Ø§Ù„Ø¨ Ø§ÙˆÙ„ÛŒÙ‡
                    if (!val || val === 'IR' || val === '-') {
                        group.classList.add('is-empty');
                    } else {
                        group.classList.remove('is-empty');
                    }
                };

                [nameInput, cardInput, ibanInput, accInput].forEach(input => {
                    // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
                    updateAttr(input);
                    if(input !== nameInput) checkEmpty(input);
                    
                    input.addEventListener('input', function() {
                        updateAttr(this);
                        if(this !== nameInput) checkEmpty(this);
                    });
                });

                // --- Ù…Ù†Ø·Ù‚ Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª Ùˆ ØªØ´Ø®ÛŒØµ Ø¨Ø§Ù†Ú© ---
                cardInput.addEventListener('input', function(e) {
                    let value = this.value.replace(/\D/g, '');
                    
                    // ØªØ´Ø®ÛŒØµ Ù†Ø§Ù… Ø¨Ø§Ù†Ú©
                    if (value.length >= 6) {
                        const bin = value.substring(0, 6);
                        if (banks[bin]) {
                            nameInput.value = banks[bin];
                            nameInput.setAttribute('value', banks[bin]); // Ø°Ø®ÛŒØ±Ù‡ ÙÙˆØ±ÛŒ Ù†Ø§Ù… Ø¨Ø§Ù†Ú©
                        }
                    }
                    
                    let formatted = '';
                    for (let i = 0; i < value.length; i++) {
                        if (i > 0 && i % 4 === 0) formatted += '-';
                        formatted += value[i];
                    }
                    this.value = formatted;
                    updateAttr(this); // Ø°Ø®ÛŒØ±Ù‡ ÙØ±Ù…Øª Ø¬Ø¯ÛŒØ¯
                });

                // --- Ù…Ù†Ø·Ù‚ Ø´Ù…Ø§Ø±Ù‡ Ø´Ø¨Ø§ ---
                ibanInput.addEventListener('input', function() {
                    let value = this.value.replace(/[^0-9]/g, ''); 
                    let formatted = 'IR';
                    for (let i = 0; i < value.length; i++) {
                        if (i > 0 && i % 4 === 0) formatted += '-';
                        formatted += value[i];
                    }
                    this.value = formatted;
                    updateAttr(this);
                });
                if(!ibanInput.value) { 
                    ibanInput.value = "IR"; 
                    updateAttr(ibanInput); 
                }

                // --- Ù…Ù†Ø·Ù‚ Ø´Ù…Ø§Ø±Ù‡ Ø­Ø³Ø§Ø¨ ---
                accInput.addEventListener('input', function() {
                    let value = this.value.replace(/\D/g, '');
                    let formatted = '';
                    for (let i = 0; i < value.length; i++) {
                        if (i > 0 && i % 4 === 0) formatted += '-';
                        formatted += value[i];
                    }
                    this.value = formatted;
                    updateAttr(this);
                });

                // --- Ù…Ù†Ø·Ù‚ Ú©Ù¾ÛŒ Ø¨Ø§ ØªØºÛŒÛŒØ± Ù…ØªÙ† ---
                const inputs = [cardInput, ibanInput, accInput];
                inputs.forEach(input => {
                    input.addEventListener('click', function(e) {
                        if (document.body.classList.contains('visitor-mode')) {
                            e.preventDefault();
                            
                            if (this.getAttribute('data-copying') === 'true') return;

                            const originalText = this.value;
                            const textToCopy = originalText.replace(/-/g, '');

                            const triggerFeedback = () => {
                                this.setAttribute('data-copying', 'true');
                                this.value = "Ú©Ù¾ÛŒ Ø´Ø¯";
                                this.classList.add('copy-success');
                                
                                setTimeout(() => {
                                    this.value = originalText;
                                    this.classList.remove('copy-success');
                                    this.removeAttribute('data-copying');
                                }, 2000);
                            };

                            if (navigator.clipboard) {
                                navigator.clipboard.writeText(textToCopy).then(triggerFeedback);
                            } else {
                                this.select();
                                document.execCommand('copy');
                                triggerFeedback();
                                window.getSelection().removeAllRanges();
                            }
                        }
                    });
                    
                    input.addEventListener('keydown', function(e) {
                        if (document.body.classList.contains('visitor-mode')) e.preventDefault();
                    });
                });
            }

            // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
            grid.querySelectorAll('.bank-card').forEach(setupCardEvents);

        })();
    </script>
</section>