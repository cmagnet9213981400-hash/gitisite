<!-- 
  =================================
  Ù…Ø§Ú˜ÙˆÙ„: ØªÙ…Ø§Ø³ Ùˆ Ù†Ù‚Ø´Ù‡ (Contact & Map)
  =================================
  Ø´Ø§Ù…Ù„: 
  - Ù†Ù‚Ø´Ù‡ Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ú©Ø§Ù† (Ú©Ù„ÛŒÚ© Ùˆ Ø¯Ø±Ú¯)
  - Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§ÛŒ Ù¾ÙˆÛŒØ§ Ø¨Ø±Ø§ÛŒ ØªÙ„ÙÙ† Ùˆ Ø§ÛŒÙ…ÛŒÙ„
  - Ú©Ù¾ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¨Ø§ ÙÛŒØ¯Ø¨Ú© "Ú©Ù¾ÛŒ Ø´Ø¯"
  - ØºÛŒØ±Ù‚Ø§Ø¨Ù„ ÙˆÛŒØ±Ø§ÛŒØ´ Ø¨ÙˆØ¯Ù† Ø¯Ø± Ø®Ø±ÙˆØ¬ÛŒ
-->
<section class="section" id="section-UNIQUE_ID" data-section="contact-map">
    <!-- Ù‡Ù†Ø¯Ù„ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ -->
    <div class="drag-handle">
        <i class="fas fa-arrows-alt-v"></i>
    </div>
    
    <!-- Ø¹Ù†ÙˆØ§Ù† Ø³Ú©Ø´Ù† -->
    <div class="section-title">
        <div class="section-title-text" contenteditable="true">ØªÙ…Ø§Ø³ Ø¨Ø§ Ù…Ø§</div>
        <div class="delete-section" onclick="deleteSection('section-UNIQUE_ID')">ğŸ—‘ï¸</div>
    </div>
    
    <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ -->
    <div class="section-content">
        <div class="contact-map-wrapper">
            
            <!-- Ø¨Ø®Ø´ Ù†Ù‚Ø´Ù‡ -->
            <div class="map-container-box">
                <div id="map-UNIQUE_ID" class="leaflet-map-component" data-lat="35.6892" data-lng="51.3890" data-zoom="13"></div>
                <div class="map-overlay-hint">Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÙˆÙ‚Ø¹ÛŒØªØŒ Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ÛŒØ§ Ù†Ø´Ø§Ù†Ú¯Ø± Ø±Ø§ Ø¬Ø§Ø¨Ø¬Ø§ Ú©Ù†ÛŒØ¯</div>
                <div class="map-visitor-overlay" title="Ø¨Ø±Ø§ÛŒ Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯">
                    <span class="nav-icon"><i class="fas fa-location-arrow"></i> Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ</span>
                </div>
            </div>

            <!-- Ø¨Ø®Ø´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙ…Ø§Ø³ -->
            <div class="contact-info-box">
                
                <!-- Ø¢Ø¯Ø±Ø³ -->
                <div class="info-group address-group">
                    <div class="group-header">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Ø¢Ø¯Ø±Ø³</span>
                    </div>
                    <div class="editable-address" contenteditable="true" data-placeholder="Ø¢Ø¯Ø±Ø³ Ø¯Ù‚ÛŒÙ‚ Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯...">Ø¢Ø¯Ø±Ø³ Ø¯Ù‚ÛŒÙ‚ Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯...</div>
                </div>

                <!-- ØªÙ„ÙÙ†â€ŒÙ‡Ø§ -->
                <div class="info-group phones-group">
                    <div class="group-header">
                        <i class="fas fa-phone-alt"></i>
                        <span>ØªÙ„ÙÙ†â€ŒÙ‡Ø§</span>
                        <button class="btn-add-item" id="add-phone-UNIQUE_ID"><i class="fas fa-plus"></i></button>
                    </div>
                    <div class="items-list" id="phone-list-UNIQUE_ID">
                        <!-- Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ØªÙ„ÙÙ† -->
                    </div>
                </div>

                <!-- Ø§ÛŒÙ…ÛŒÙ„â€ŒÙ‡Ø§ -->
                <div class="info-group emails-group">
                    <div class="group-header">
                        <i class="fas fa-envelope"></i>
                        <span>Ø§ÛŒÙ…ÛŒÙ„â€ŒÙ‡Ø§</span>
                        <button class="btn-add-item" id="add-email-UNIQUE_ID"><i class="fas fa-plus"></i></button>
                    </div>
                    <div class="items-list" id="email-list-UNIQUE_ID">
                        <!-- Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ…ÛŒÙ„ -->
                    </div>
                </div>

            </div>
        </div>
    </div>

    <style>
        #section-UNIQUE_ID .contact-map-wrapper {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }

        /* Ù†Ù‚Ø´Ù‡ */
        #section-UNIQUE_ID .map-container-box {
            flex: 1;
            min-width: 300px;
            height: 400px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            border: 1px solid var(--glass-border);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 1;
        }

        #section-UNIQUE_ID .leaflet-map-component {
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        #section-UNIQUE_ID .map-overlay-hint {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8rem;
            z-index: 500; /* Ø¨Ø§Ù„Ø§ØªØ± Ø§Ø² Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ù†Ù‚Ø´Ù‡ */
            pointer-events: none;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        #section-UNIQUE_ID .map-visitor-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s;
        }

        #section-UNIQUE_ID .map-visitor-overlay:hover {
            opacity: 1;
        }

        #section-UNIQUE_ID .nav-icon {
            background: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transform: translateY(10px);
            transition: transform 0.3s;
        }

        #section-UNIQUE_ID .map-visitor-overlay:hover .nav-icon {
            transform: translateY(0);
        }

        /* Ø¨Ø§Ú©Ø³ Ø§Ø·Ù„Ø§Ø¹Ø§Øª */
        #section-UNIQUE_ID .contact-info-box {
            flex: 1;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        #section-UNIQUE_ID .info-group {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 15px;
            transition: all 0.3s;
        }

        #section-UNIQUE_ID .group-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-size: 1.1rem;
            color: var(--primary-color);
            border-bottom: 1px solid var(--glass-border);
            padding-bottom: 8px;
        }

        #section-UNIQUE_ID .btn-add-item {
            margin-right: auto;
            background: var(--secondary-color);
            color: white;
            border: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            transition: background 0.2s;
        }

        #section-UNIQUE_ID .btn-add-item:hover {
            background: var(--primary-color);
        }

        #section-UNIQUE_ID .editable-address {
            min-height: 60px;
            line-height: 1.6;
            outline: none;
            white-space: pre-wrap;
        }

        /* Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù„ÛŒØ³Øª */
        #section-UNIQUE_ID .contact-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            background: rgba(0, 0, 0, 0.1);
            padding: 8px;
            border-radius: 8px;
            position: relative;
        }

        #section-UNIQUE_ID .item-input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text-color);
            font-family: inherit;
            outline: none;
            direction: ltr;
            text-align: right;
            font-size: 1rem;
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ù…ÙˆÙÙ‚ÛŒØª Ú©Ù¾ÛŒ */
        #section-UNIQUE_ID .item-input.copy-success {
            color: #2ecc71 !important;
            font-weight: bold;
            text-align: center;
            background: rgba(46, 204, 113, 0.1);
            border-radius: 4px;
        }

        #section-UNIQUE_ID .btn-delete-item {
            color: #ff6b6b;
            background: transparent;
            border: none;
            cursor: pointer;
            opacity: 0.7;
            padding: 5px;
        }

        #section-UNIQUE_ID .btn-delete-item:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        /* --- VISITOR MODE STYLES --- */
        
        body.visitor-mode #section-UNIQUE_ID .btn-add-item,
        body.visitor-mode #section-UNIQUE_ID .btn-delete-item,
        body.visitor-mode #section-UNIQUE_ID .map-overlay-hint,
        body.visitor-mode #section-UNIQUE_ID .drag-handle,
        body.visitor-mode #section-UNIQUE_ID .delete-section,
        body.visitor-mode #section-UNIQUE_ID .section-title {
            display: none !important;
        }

        /* ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù„Ø§ÛŒÙ‡ Ú©Ù„ÛŒÚ© Ù†Ù‚Ø´Ù‡ Ø¨Ø±Ø§ÛŒ Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ */
        body.visitor-mode #section-UNIQUE_ID .map-visitor-overlay {
            display: flex;
        }

        /* ØºÛŒØ±Ù‚Ø§Ø¨Ù„ ÙˆÛŒØ±Ø§ÛŒØ´ Ú©Ø±Ø¯Ù† Ø¢Ø¯Ø±Ø³ */
        body.visitor-mode #section-UNIQUE_ID .editable-address {
            pointer-events: none; /* ÙÙ‚Ø· Ù…ØªÙ† Ø¨Ø§Ø´Ø¯ */
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø§ÛŒÙ†Ù¾ÙˆØªâ€ŒÙ‡Ø§ Ø¯Ø± Ø®Ø±ÙˆØ¬ÛŒ (Ø´Ø¨ÛŒÙ‡ Ù…ØªÙ†ØŒ Ù‚Ø§Ø¨Ù„ Ú©Ù„ÛŒÚ©) */
        body.visitor-mode #section-UNIQUE_ID .item-input {
            cursor: pointer;
            pointer-events: auto; /* ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ Ú©Ù¾ÛŒ */
            border-bottom: 1px dashed rgba(255,255,255,0.3); /* Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¨ØµØ±ÛŒ Ø¨Ø±Ø§ÛŒ Ú©Ù„ÛŒÚ© */
        }
        
        body.visitor-mode #section-UNIQUE_ID .item-input:hover {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        body.visitor-mode #section-UNIQUE_ID .contact-item:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§ÛŒ Ø®Ø§Ù„ÛŒ */
        body.visitor-mode #section-UNIQUE_ID .info-group.is-empty,
        body.visitor-mode #section-UNIQUE_ID .contact-item.is-empty {
            display: none !important;
        }
    </style>

    <script>
        (function() {
            const uid = 'UNIQUE_ID';
            const mapContainer = document.getElementById('map-' + uid);
            const addressEl = document.querySelector('#section-' + uid + ' .editable-address');
            const addPhoneBtn = document.getElementById('add-phone-' + uid);
            const phoneList = document.getElementById('phone-list-' + uid);
            const addEmailBtn = document.getElementById('add-email-' + uid);
            const emailList = document.getElementById('email-list-' + uid);
            const isVisitor = document.body.classList.contains('visitor-mode');
            
            // --- Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ù‚Ø´Ù‡ (Leaflet) ---
            let map, marker;
            
            function initMap() {
                if (!L) return;

                const lat = parseFloat(mapContainer.getAttribute('data-lat')) || 35.6892;
                const lng = parseFloat(mapContainer.getAttribute('data-lng')) || 51.3890;
                const zoom = parseInt(mapContainer.getAttribute('data-zoom')) || 13;

                map = L.map(mapContainer).setView([lat, lng], zoom);

                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: 'Â© OpenStreetMap'
                }).addTo(map);

                // Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø§Ø±Ú©Ø±
                marker = L.marker([lat, lng], {
                    draggable: !isVisitor // ÙÙ‚Ø· Ø¯Ø± Ø§Ø¯Ù…ÛŒÙ† Ù‚Ø§Ø¨Ù„ Ø¯Ø±Ú¯ Ø§Ø³Øª
                }).addTo(map);

                if (!isVisitor) {
                    // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ Ù…Ø§Ø±Ú©Ø± Ø¨Ø§ Ø¯Ø±Ú¯
                    marker.on('dragend', function(e) {
                        const position = marker.getLatLng();
                        saveMapData(position.lat, position.lng, map.getZoom());
                    });

                    // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù†Ù‚Ø´Ù‡ Ø¨Ø±Ø§ÛŒ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ Ù…Ø§Ø±Ú©Ø± (Drop Pin)
                    map.on('click', function(e) {
                        marker.setLatLng(e.latlng);
                        saveMapData(e.latlng.lat, e.latlng.lng, map.getZoom());
                    });

                    // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø²ÙˆÙ…
                    map.on('zoomend', function() {
                        const position = marker.getLatLng();
                        saveMapData(position.lat, position.lng, map.getZoom());
                    });
                } else {
                    // Ø¯Ø± Ø­Ø§Ù„Øª Ø¨Ø§Ø²Ø¯ÛŒØ¯Ú©Ù†Ù†Ø¯Ù‡ØŒ Ø²ÙˆÙ… Ùˆ Ø§Ø³Ú©Ø±ÙˆÙ„ Ù†Ù‚Ø´Ù‡ Ø±Ø§ ØºÛŒØ±ÙØ¹Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… ØªØ§ Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù„Ø§ÛŒÙ‡ Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ ØªØ¯Ø§Ø®Ù„ Ù†Ú©Ù†Ø¯
                    map.dragging.disable();
                    map.touchZoom.disable();
                    map.doubleClickZoom.disable();
                    map.scrollWheelZoom.disable();
                }

                setTimeout(() => { map.invalidateSize(); }, 500);
            }

            function saveMapData(lat, lng, zoom) {
                mapContainer.setAttribute('data-lat', lat);
                mapContainer.setAttribute('data-lng', lng);
                mapContainer.setAttribute('data-zoom', zoom);
            }

            // Ø§Ø¬Ø±Ø§ÛŒ Ù†Ù‚Ø´Ù‡
            // Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù…Ø´Ú©Ù„ Ù„ÙˆØ¯ Ù†Ø´Ø¯Ù† ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø¯Ø± Ù…ÙˆØ¯Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø®ÙÛŒ ÛŒØ§ ØªØ¨â€ŒÙ‡Ø§ØŒ Ú©Ù…ÛŒ ØªØ§Ø®ÛŒØ± Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ…
            setTimeout(initMap, 100);

            // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ (Visitor Mode)
            const visitorOverlay = document.querySelector('#section-' + uid + ' .map-visitor-overlay');
            if (visitorOverlay) {
                visitorOverlay.addEventListener('click', () => {
                    const lat = mapContainer.getAttribute('data-lat');
                    const lng = mapContainer.getAttribute('data-lng');
                    const url = `https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}`;
                    window.open(url, '_blank');
                });
            }

            // --- Ù…Ø¯ÛŒØ±ÛŒØª Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§ (ØªÙ„ÙÙ† Ùˆ Ø§ÛŒÙ…ÛŒÙ„) ---

            function createItem(type, value = '') {
                const item = document.createElement('div');
                item.className = 'contact-item';
                
                const placeholder = type === 'phone' ? 'Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³...' : 'Ø§ÛŒÙ…ÛŒÙ„...';
                const inputType = type === 'email' ? 'email' : 'tel';
                
                // Ø¯Ø± Ø­Ø§Ù„Øª ÙˆÛŒØ²ÛŒØªÙˆØ±ØŒ Ø§ÛŒÙ†Ù¾ÙˆØª Ø±Ø§ readonly Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
                const readOnlyAttr = isVisitor ? 'readonly' : '';
                
                item.innerHTML = `
                    <input type="${inputType}" class="item-input" placeholder="${placeholder}" value="${value}" ${readOnlyAttr}>
                    <button class="btn-delete-item" title="Ø­Ø°Ù">&times;</button>
                `;

                const input = item.querySelector('.item-input');
                const deleteBtn = item.querySelector('.btn-delete-item');

                // Ø°Ø®ÛŒØ±Ù‡ Ù…Ù‚Ø¯Ø§Ø± Ø¨Ø±Ø§ÛŒ HTML
                input.addEventListener('input', () => {
                    input.setAttribute('value', input.value);
                    checkEmptyItem(item);
                });

                // Ø­Ø°Ù Ø¢ÛŒØªÙ…
                deleteBtn.addEventListener('click', () => {
                    item.remove();
                    checkGroupVisibility();
                });

                // --- Ú©Ù¾ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ (Visitor Mode) ---
                if (isVisitor) {
                    input.addEventListener('click', (e) => {
                        e.preventDefault(); // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ÙÙˆÚ©ÙˆØ³ Ùˆ ØªØ§ÛŒÙ¾
                        
                        // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ØªØ¯Ø§Ø®Ù„ Ø§Ú¯Ø± Ø¯Ø± Ø­Ø§Ù„ Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ø§Ø³Øª
                        if (input.dataset.copying === "true") return;

                        const originalText = input.value;
                        if (!originalText) return;

                        const triggerFeedback = () => {
                            input.dataset.copying = "true";
                            input.value = "Ú©Ù¾ÛŒ Ø´Ø¯"; // ØªØºÛŒÛŒØ± Ù…ØªÙ†
                            input.classList.add('copy-success');
                            
                            setTimeout(() => {
                                input.value = originalText; // Ø¨Ø§Ø²Ú¯Ø´Øª Ù…ØªÙ† Ø§ØµÙ„ÛŒ
                                input.classList.remove('copy-success');
                                input.dataset.copying = "false";
                            }, 2000); // 2 Ø«Ø§Ù†ÛŒÙ‡
                        };

                        if (navigator.clipboard) {
                            navigator.clipboard.writeText(originalText).then(triggerFeedback);
                        } else {
                            input.select();
                            document.execCommand('copy');
                            triggerFeedback();
                            window.getSelection().removeAllRanges();
                        }
                    });
                    
                    // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ØªØ§ÛŒÙ¾ (Ù„Ø§ÛŒÙ‡ Ø§Ù…Ù†ÛŒØªÛŒ Ø¯ÙˆÙ…)
                    input.addEventListener('keydown', (e) => e.preventDefault());
                }

                return item;
            }

            // ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø±Ø³ÛŒ Ø®Ø§Ù„ÛŒ Ø¨ÙˆØ¯Ù†
            function checkEmptyItem(item) {
                const val = item.querySelector('.item-input').value.trim();
                if (!val) item.classList.add('is-empty');
                else item.classList.remove('is-empty');
                checkGroupVisibility();
            }

            function checkGroupVisibility() {
                // Ø¢Ø¯Ø±Ø³
                const addrGroup = addressEl.closest('.info-group');
                const addrVal = addressEl.textContent.trim();
                const addrPlace = addressEl.getAttribute('data-placeholder');
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ø¢ÛŒØ§ Ù…ØªÙ† Ø¨Ø±Ø§Ø¨Ø± Ù¾Ù„ÛŒØ³â€ŒÙ‡ÙˆÙ„Ø¯Ø± Ø§Ø³Øª ÛŒØ§ Ø®Ø§Ù„ÛŒ
                if (!addrVal || addrVal === addrPlace) addrGroup.classList.add('is-empty');
                else addrGroup.classList.remove('is-empty');

                // Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§
                [phoneList, emailList].forEach(list => {
                    const group = list.closest('.info-group');
                    const hasVisibleItems = Array.from(list.children).some(item => !item.classList.contains('is-empty'));
                    
                    if (!hasVisibleItems && list.children.length > 0) {
                        // Ø§Ú¯Ø± Ø¢ÛŒØªÙ… Ø¯Ø§Ø±Ø¯ ÙˆÙ„ÛŒ Ù‡Ù…Ù‡ Ø®Ø§Ù„ÛŒ Ù‡Ø³ØªÙ†Ø¯
                        group.classList.add('is-empty');
                    } else if (list.children.length === 0) {
                        // Ø§Ú¯Ø± Ù‡ÛŒÚ† Ø¢ÛŒØªÙ…ÛŒ Ù†Ø¯Ø§Ø±Ø¯
                        group.classList.add('is-empty');
                    } else {
                        group.classList.remove('is-empty');
                    }
                });
            }

            // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙØ²ÙˆØ¯Ù† (ÙÙ‚Ø· Ø§Ø¯Ù…ÛŒÙ†)
            if (addPhoneBtn) {
                addPhoneBtn.addEventListener('click', () => {
                    const item = createItem('phone');
                    phoneList.appendChild(item);
                    checkEmptyItem(item);
                });
            }

            if (addEmailBtn) {
                addEmailBtn.addEventListener('click', () => {
                    const item = createItem('email');
                    emailList.appendChild(item);
                    checkEmptyItem(item);
                });
            }

            // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ø¢Ø¯Ø±Ø³
            addressEl.addEventListener('input', checkGroupVisibility);
            addressEl.addEventListener('focus', function() {
                if (this.textContent.trim() === this.getAttribute('data-placeholder')) this.textContent = '';
            });
            addressEl.addEventListener('blur', function() {
                if (this.textContent.trim() === '') this.textContent = this.getAttribute('data-placeholder');
                checkGroupVisibility();
            });

            // Ø¨Ø§Ø²Ø³Ø§Ø²ÛŒ Ù„ÛŒØ³Øªâ€ŒÙ‡Ø§ Ù‡Ù†Ú¯Ø§Ù… Ù„ÙˆØ¯ (Rehydration)
            const rehydrateList = (list, type) => {
                Array.from(list.children).forEach(item => {
                    const input = item.querySelector('.item-input');
                    const deleteBtn = item.querySelector('.btn-delete-item');
                    
                    // Ø§ØªØµØ§Ù„ Ù…Ø¬Ø¯Ø¯ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§
                    input.addEventListener('input', () => {
                        input.setAttribute('value', input.value);
                        checkEmptyItem(item);
                    });
                    
                    deleteBtn.addEventListener('click', () => {
                        item.remove();
                        checkGroupVisibility();
                    });

                    // Ù…Ù†Ø·Ù‚ Ú©Ù¾ÛŒ (ØªÚ©Ø±Ø§Ø± Ø¨Ø±Ø§ÛŒ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯)
                    if (isVisitor) {
                        input.setAttribute('readonly', 'true'); // Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² readonly Ø¨ÙˆØ¯Ù†
                        input.addEventListener('click', (e) => {
                            e.preventDefault();
                            if (input.dataset.copying === "true") return;

                            const originalText = input.value;
                            if(!originalText) return;

                            const triggerFeedback = () => {
                                input.dataset.copying = "true";
                                input.value = "Ú©Ù¾ÛŒ Ø´Ø¯";
                                input.classList.add('copy-success');
                                setTimeout(() => {
                                    input.value = originalText;
                                    input.classList.remove('copy-success');
                                    input.dataset.copying = "false";
                                }, 2000);
                            };

                            if (navigator.clipboard) {
                                navigator.clipboard.writeText(originalText).then(triggerFeedback);
                            } else {
                                input.select();
                                document.execCommand('copy');
                                triggerFeedback();
                            }
                        });
                        input.addEventListener('keydown', (e) => e.preventDefault());
                    }
                    
                    checkEmptyItem(item);
                });
            };

            rehydrateList(phoneList, 'phone');
            rehydrateList(emailList, 'email');
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ ÙˆØ¶Ø¹ÛŒØª Ù†Ù…Ø§ÛŒØ´
            checkGroupVisibility();

        })();
    </script>
</section>